# 12-ç¬¦å·æ‰§è¡Œ

* å®šä¹‰ï¼šå°†ç¨‹åºä¸­çš„å˜é‡æ›¿æ¢ä¸ºç¬¦å·å€¼ï¼Œæ‰§è¡Œç¨‹åºä»¥æŽ¢ç´¢æ‰€æœ‰å¯èƒ½çš„è·¯å¾„ã€‚
  * æ¯ä¸ªè¾“å…¥å˜é‡å’Œä¸€ä¸ªç¬¦å·å…³è”
  * æ¯ä¸ªè¡¨è¾¾å¼éƒ½æ˜¯ç¬¦å·è¡¨è¾¾å¼
  * ç¨‹åºçš„è·¯å¾„ï¼šä»¥è·¯å¾„çº¦æŸï¼ˆä¸€ç»„æ¡ä»¶è¡¨è¾¾å¼ï¼‰æè¿°åˆ†æ”¯å¤„çš„è·¯å¾„é€‰æ‹©
* è·¯å¾„æ•æ„Ÿ Path-Sensitiveï¼šç¨‹åºä¸­ä¸åŒçš„æ‰§è¡Œè·¯å¾„ä¼šè¢«åˆ†åˆ«åˆ†æžã€åˆ†åˆ«è¿½è¸ªã€‚
* ç›®æ ‡ï¼šå‘çŽ°ç¨‹åºä¸­çš„é”™è¯¯ã€æ¼æ´žæˆ–ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºï¼ˆå¦‚é™¤é›¶é”™è¯¯ã€è¶Šç•Œè®¿é—®ç­‰ï¼‰ã€‚

## æ£€æŸ¥æ–­è¨€ï¼šçº¦æŸæ±‚è§£

* $$\sigma$$ï¼šè®°å½•ç¬¦å·å€¼ï¼Œå¦‚`ðˆ = { a -> ðœ¶_a ; b -> ðœ¶_b ; x -> 1 ; y -> 0 }`ï¼Œåœ¨è¯­å¥æ‰§è¡ŒåŽæ”¹å˜
* $$\pi$$ï¼šè·¯å¾„çº¦æŸï¼Œè®°å½•åˆ†æ”¯æ¡ä»¶ï¼Œå¦‚`ðœ‹ = { x > 0 ; y < 10 }`ï¼Œåˆå§‹ä¸º`true`ï¼Œåœ¨æ¯ä¸€æ¬¡åˆ†æ”¯å¤„æ”¹å˜
* æ£€æŸ¥`assert(cond)`è¯­å¥ï¼šæž„é€ è¿åæ¡ä»¶ï¼š$$eg cond$$ï¼Œå¦‚æžœ$$\pi \land \neg cond$$ä¸ºå‡ï¼ˆå³åœ¨$$\pi$$æ¡ä»¶ä¸‹ä¸å¯èƒ½å‘ç”Ÿè¿åæ¡ä»¶ï¼‰ï¼Œåˆ™ä¸ä¼šå¤±è´¥

```c
int x = 1, y = 0;
if (a != 0) {
    y = 3 + x;
    if (b == 0) {
        x = 2 * (a + b);
    }
}
assert(x - y != 0);
```

* ä¸‹ä¸€æ­¥ç›®æ ‡ï¼šæ£€æŸ¥è¯¸å¦‚$$\pi \land \neg cond$$çš„æ¡ä»¶åˆ¤æ–­å¼æ˜¯å¦æˆç«‹
* ä½¿ç”¨**çº¦æŸæ±‚è§£å™¨** Constraint Solver æ¥åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶
  * å¯æ»¡è¶³ Satisfiableï¼šå­˜åœ¨`assert`å¤±è´¥çš„å¯èƒ½æ€§
  * ä¸å¯æ»¡è¶³ Unsatisfiableï¼š`assert`ä¸ä¼šå¤±è´¥
  * æœªçŸ¥ Unknownï¼šæ— æ³•ç¡®å®šæ˜¯å¦å­˜åœ¨å¤±è´¥å¯èƒ½æ€§ï¼ˆè¿‡äºŽå¤æ‚ï¼Œè¶…æ—¶ï¼‰

### é™åˆ¶

* å¯æ‹“å±•æ€§
  * Path Explosionï¼šè·¯å¾„æ•°é‡éšç€åˆ†æ”¯å’Œå¾ªçŽ¯çš„å¢žåŠ è€ŒæŒ‡æ•°çº§å¢žé•¿
  * External Callsï¼šå¤–éƒ¨å‡½æ•°è°ƒç”¨å¯èƒ½å¯¼è‡´è·¯å¾„ä¸ç¡®å®š
  * Constraint Solvingï¼šå¤æ‚çš„çº¦æŸå¯èƒ½å¯¼è‡´æ±‚è§£å™¨æ— æ³•å¤„ç†
* ä¼˜åŒ–æ–¹æ³•
  * Path/State Mergingï¼šåˆå¹¶ç›¸ä¼¼è·¯å¾„æˆ–çŠ¶æ€ï¼Œå‡å°‘è·¯å¾„æ•°é‡
    * å¼•å…¥`ite(cond, true_val, false_val)`å‡½æ•°ï¼Œåˆå¹¶ç›¸ä¼¼è·¯å¾„
  * Induction for Loopsï¼šå¯¹å¾ªçŽ¯è¿›è¡Œå½’çº³ï¼Œå‡å°‘è·¯å¾„æ•°é‡
    * æŠŠå¾ªçŽ¯å†…å®¹è½¬åŒ–ä¸ºæ¡ä»¶è¡¨è¾¾å¼ï¼ˆä¸ä¸€å®šå§‹ç»ˆå¯ç”¨ï¼‰
  * Concolic Executionï¼šç»“åˆç¬¦å·æ‰§è¡Œå’Œå…·ä½“æ‰§è¡Œï¼Œè¿è¡Œæ—¶ ç”Ÿæˆç¬¦å·å€¼
  * Speculative Executionï¼šé¢„æµ‹è·¯å¾„ï¼Œæå‰æ‰§è¡Œå¯èƒ½çš„åˆ†æ”¯

## å¯æ»¡è¶³æ€§ Satisfiability

### å‘½é¢˜é€»è¾‘ Proposition Logic

* åªæ¶‰åŠå‘½é¢˜å˜é‡å’Œé€»è¾‘è¿ç®—ï¼Œä¸æ¶‰åŠå…·ä½“å˜é‡çš„è¿ç®—
* çœŸå€¼ç¬¦å·ï¼ˆ$$b$$ï¼‰ï¼š$$\top$$ å’Œ $$\bot$$ï¼ˆçœŸå’Œå‡ï¼‰
* å‘½é¢˜å˜é‡ï¼ˆ$$v$$ï¼‰ï¼š$$p$$ã€$$q$$ã€$$r$$ ç­‰
* æ–‡å­—ï¼ˆ$$l$$ï¼‰ï¼šåŽŸå­æˆ–å…¶å¦å®š
* å…¬å¼ï¼ˆ$$F$$ï¼‰ï¼š
  * $$l$$
  * $$\lnot F$$ï¼ˆå¦å®šï¼‰
  * $$F_1 \lor F_2$$ï¼ˆæˆ–ï¼‰
  * $$F_1 \land F_2$$ï¼ˆä¸Žï¼‰
  * $$F_1 \Rightarrow F_2$$ï¼ˆè•´å«ï¼‰
  * $$F_1 \Leftrightarrow F_2$$ï¼ˆç­‰ä»·ï¼‰
* å¯æ»¡è¶³ Satisfiableï¼š**å­˜åœ¨ä¸€ç§**çœŸå€¼èµ‹å€¼ä½¿å¾—å…¬å¼ä¸ºçœŸ
* æœ‰æ•ˆ Validï¼š**å¯¹äºŽæ‰€æœ‰**çœŸå€¼èµ‹å€¼ï¼Œå…¬å¼éƒ½ä¸ºçœŸ
* åœ¨å‘½é¢˜é€»è¾‘ä¸­çš„æ‰€æœ‰å…¬å¼$$F$$ï¼Œ$$F$$æœ‰æ•ˆå½“ä¸”ä»…å½“$$\lnot F$$ä¸å¯æ»¡è¶³

## èŒƒå¼ Normal Form

* å¯¹å…¬å¼è¯­æ³•çš„é™åˆ¶ï¼ŒæŠŠå…¬å¼è¯­æ³•è§„èŒƒåŒ–ä¸ºæŸç§æŽ¥å£
* æœ‰åŠ©äºŽç®€åŒ–åˆ¤å®šæµç¨‹

### å¦å®šèŒƒå¼ Negation Normal Form (NNF)

* å®šä¹‰ï¼šä¸å…è®¸ä½¿ç”¨è•´å«/ç­‰ä»·ï¼ˆ$$ightarrow \Leftrightarrow$$ï¼‰è¿ç®—ç¬¦ï¼Œåªå…è®¸å¯¹å˜é‡å–å¦ï¼ˆ$$\lnot$$ï¼‰ï¼Œä¸å…è®¸å¯¹æ›´å¤æ‚çš„å­å…¬å¼å–å¦
* æ‰€æœ‰çš„å…¬å¼éƒ½å¯ä»¥è½¬æ¢ä¸º NNF

### åˆå–èŒƒå¼ Conjunctive Normal Form (CNF)

* å®šä¹‰ï¼šåˆå–èŒƒå¼ï¼ˆCNFï¼‰æ˜¯ä¸€ä¸ªå…¬å¼ï¼Œç”±è‹¥å¹²â€œæžå–é¡¹ï¼ˆ$$\lor$$ï¼‰â€ä¹‹é—´é€šè¿‡åˆå–ï¼ˆ$$\land$$ï¼‰è¿žæŽ¥ç»„æˆã€‚
  * å…¬å¼ä¸­åªå…è®¸ä½¿ç”¨ $$\lor$$ã€$$\land$$ å’Œ $$\lnot$$ï¼Œå…¶ä¸­ï¼š
  * $$\lnot$$ åªèƒ½ä½œç”¨äºŽåŽŸå­å‘½é¢˜å˜é‡
  * æœ€å¤–å±‚æ˜¯åˆå–ï¼ˆ$$\land$$ï¼‰ã€‚
  * æžå–é¡¹ä¸­ä¸åº”å†åŒ…å« $$\land$$ã€‚
* å½¢å¼ï¼š$$(l_1 \lor l_2 \lor \ldots) \land (l_3 \lor \lnot l_4 \lor \ldots) \land \ldots$$
* æ‰€æœ‰çš„å…¬å¼éƒ½å¯ä»¥è½¬æ¢ä¸º CNF

### æžå–èŒƒå¼ Disjunctive Normal Form (DNF)

* å®šä¹‰ï¼šæžå–èŒƒå¼ï¼ˆDNFï¼‰æ˜¯ä¸€ä¸ªå…¬å¼ï¼Œç”±è‹¥å¹²â€œåˆå–é¡¹ï¼ˆ$$\land$$ï¼‰â€ä¹‹é—´é€šè¿‡æžå–ï¼ˆ$$\lor$$ï¼‰è¿žæŽ¥ç»„æˆã€‚
  * å…¬å¼ä¸­åªå…è®¸ä½¿ç”¨ $$\lor$$ã€$$\land$$ å’Œ $$\lnot$$ï¼Œå…¶ä¸­ï¼š
  * $$\lnot$$ åªèƒ½ä½œç”¨äºŽåŽŸå­å‘½é¢˜å˜é‡
  * æœ€å¤–å±‚æ˜¯æžå–ï¼ˆ$$\lor$$ï¼‰ã€‚
  * åˆå–é¡¹ä¸­ä¸åº”å†åŒ…å« $$\lor$$ã€‚
* å½¢å¼ï¼š$$(l_1 \land l_2 \land \ldots) \lor (l_3 \land \lnot l_4 \land \ldots) \lor \ldots$$
* æ‰€æœ‰çš„å…¬å¼éƒ½å¯ä»¥è½¬æ¢ä¸º DNF

## Tseitin Transformation

### åŒæ—¶å¯æ»¡è¶³æ€§ Equisatisfiability

* å®šä¹‰ï¼šä¸¤ä¸ªå…¬å¼$$F_1$$ å’Œ $$F_2$$ æ˜¯åŒæ—¶å¯æ»¡è¶³çš„ï¼Œå½“ä¸”ä»…å½“ $$F_1$$ å¯æ»¡è¶³ç­‰ä»·äºŽ $$F_2$$ å¯æ»¡è¶³
  * è¯´äººè¯ï¼šä¸¤ä¸ªå…¬å¼è¦ä¹ˆéƒ½æ˜¯å¯æ»¡è¶³çš„ï¼Œè¦ä¹ˆéƒ½æ˜¯ä¸å¯æ»¡è¶³çš„
* å¯¹äºŽä»»æ„å…¬å¼$$F$$ï¼Œå¯ä»¥æž„é€ ä¸€ä¸ªåŒæ—¶å¯æ»¡è¶³çš„ CNF èŒƒå¼å…¬å¼$$F'$$ï¼Œä¸” $$F'$$ çš„å¤§å°å€æ•°æ˜¯å¸¸æ•°çº§åˆ«çš„

### å…·ä½“å®žçŽ°

1. å»ºç«‹è¯­æ³•æ ‘ï¼ŒæŠŠæ¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹å¯¹åº”çš„è¡¨è¾¾å¼$$F_i$$æ›¿æ¢ä¸ºä¸€ä¸ªæ–°çš„å˜é‡$$x_i$$
2. æ ¹èŠ‚ç‚¹ $$F_1$$ è½¬æ¢ä¸º $$x_1 \land (x_1 \Leftrightarrow F_1)$$
3. éšåŽåœ¨å¼å­åŽé¢åŠ ä¸Š$$\land (x_i \Leftrightarrow F_i)$$ï¼Œç›´åˆ°æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹éƒ½è¢«æ›¿æ¢
4. é€šè¿‡ä¸‹é¢å¤§ä¸€ç¦»æ•£è¯¾çš„çŸ¥è¯†ï¼ŒæŠŠæ‰€æœ‰çš„$$\Leftrightarrow$$ å’Œ $$ightarrow$$ æ›¿æ¢ä¸º CNF å½¢å¼çš„åˆå–èŒƒå¼

#### ç¦»æ•£è¯¾å›žå¿†

| åŽŸå§‹é€»è¾‘å½¢å¼                  | ç”¨ä¸Ž/æˆ–/éžè¡¨ç¤º                                    |
| ----------------------- | ------------------------------------------- |
| $$A \Rightarrow B$$     | $$\lnot A \lor B$$                          |
| $$A \Leftrightarrow B$$ | $$(A \lor \lnot B) \land (\lnot A \lor B)$$ |

## SAT é—®é¢˜

* æ‰¾åˆ°æ˜¯å¦å­˜åœ¨èƒ½è®©$$F$$ ä¸ºçœŸçš„å˜é‡èµ‹å€¼
* è§£å†³æ–¹æ³•
  * é€šè¿‡ Tseitin Transformation è½¬æ¢ä¸º CNF
  * ä½¿ç”¨ DPLL ç®—æ³•ï¼ˆDavis-Putnam-Logemann-Lovelandï¼‰

### DPLL ç®—æ³•

* é€‰æ‹©ä¸€ä¸ªå˜é‡ $$v$$ï¼Œèµ‹å€¼ä¸ºçœŸ/å‡
* ä¼ æ’­è¿™ä¸ªå˜é‡çš„å€¼
* ä¼˜åŒ–
  * $$(a_0 \lor a_1 \lor \ldots \lor a_n \lor c) \land (b_0 \lor b_1 \lor \ldots \lor b_m \lor \lnot c)$$ å¯è½¬åŒ–ä¸º $$(a_0 \lor a_1 \lor \ldots \lor a_n \lor b_0 \lor b_1 \lor \ldots \lor b_m)$$

```c
bool DPLL (F, I) {
  if (F == false) return UNSAT;
  if (F == true) return SAT;
  
  p = choose(F);
  bool ret = DPLL(F[pÃ true], I[pÃ true])
  if (ret == SAT) return SAT;
  
  return DPLL(F[pÃ false], I[pÃ  false]);
}
```

### CDCL ç®—æ³•

* Conflict-Driven Clause Learning
* ä»ŽçŸ›ç›¾ä¸­å­¦ä¹ ï¼Œä¼˜åŒ–ç®—æ³•é€Ÿåº¦
* ç•¥ï¼Œæ¥ä¸åŠå¤ä¹ äº†

## ä¸€é˜¶é€»è¾‘ First-Order Logic (FOL)

* å®šä¹‰ï¼šç”±å¯¹è±¡ï¼ˆobjectsï¼‰å’Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼ˆrelationsï¼‰æž„æˆçš„é€»è¾‘ç³»ç»Ÿï¼Œå¯ä»¥è¡¨è¾¾â€œæŸä¸ªå¯¹è±¡â€ã€â€œå¯¹è±¡ä¹‹é—´çš„å…³ç³»â€å’Œâ€œå¯¹è±¡ä¸Šçš„å‡½æ•°â€ç­‰æ›´å¤æ‚ç»“æž„ã€‚
  * å¯¹è±¡ç¬¦å·ï¼š$$a, b, c, \ldots$$ï¼Œè¡¨ç¤ºå…·ä½“çš„å¯¹è±¡æˆ–ä¸ªä½“ã€‚
  * $$n$$-å…ƒè°“è¯ï¼š$$p(t_1, t_2, \ldots, t_n)$$ï¼Œè¾“å…¥ $$n$$ ä¸ªå¯¹è±¡ï¼Œè¾“å‡ºä¸€ä¸ªçœŸå‡å€¼ï¼ˆTrue/Falseï¼‰ã€‚
  * $$n$$-å…ƒå‡½æ•°ï¼š$$f(t_1, t_2, \ldots, t_n)$$ï¼Œè¾“å…¥ $$n$$ ä¸ªå¯¹è±¡ï¼Œè¾“å‡ºä¸€ä¸ªå…³ç³»ã€‚
  * å…¬å¼ï¼šé€šè¿‡è¿žæŽ¥è¯å’Œé‡è¯æž„é€ çš„é€»è¾‘è¡¨è¾¾å¼ã€‚
    * $$\top$$ $$\bot$$
    * åŽŸå­å…¬å¼ $$t$$
    * $$eg, \lor, \land, \Rightarrow, \Leftrightarrow$$
    * $$\forall x. F$$ $$\exists x. F$$
* Theory of Bit Vectorsï¼šæ‰€æœ‰æ•°æ®éƒ½æ˜¯æœ‰é•¿åº¦çš„ä½å‘é‡ï¼ŒæŠŠè¿ç®—çœ‹ä½œä½å‘é‡ä¸Šçš„é€»è¾‘è¿ç®—ï¼Œå¯ä»¥å°† FOL è½¬åŒ–ä¸º PL

### Satisfiability Modulo Theories

1. è¯çº§åˆ«å¤„ç†ï¼Œåœ¨è¯å±‚é¢åŒ–ç®€é€»è¾‘å…¬å¼
2. Bit blastingï¼šå°†å…¬å¼è½¬æ¢ä¸ºä½å‘é‡çš„å½¢å¼ï¼ŒæŠŠ FOL è½¬åŒ–ä¸º PL
3. é—®é¢˜è½¬åŒ–ä¸º SAT é—®é¢˜ï¼Œä½¿ç”¨ DPLL æˆ– CDCL ç®—æ³•æ±‚è§£
