# 14\~15-软件构造

* **包含活动**：详细设计、编程、测试、调试、代码评审、集成与构建、构造管理

## 名词解释

* **重构**：修改软件系统的严谨方法，在不改变代码外部表现的情况下改进其内部结构。
* **测试驱动开发**：程序员在编写代码前，优先完成该段代码的测试代码。并在编程中重复执行测试代码，以验证程序的正确性。
* **结对编程**：两个程序员挨着坐在一起，共同协作进行软件构造活动。

## 代码质量评判

* 格式：对齐、缩进
* 布局
  * 空行、空格分割不同代码块，长句断行
  * 类的书写顺序为成员变量、构造函数、方法
* 命名
* 注释：Javadoc
* 避免：太长的方法/参数、太大的类、相似复制控制结构、重复代码、过多注释

### 优化条件判断

* 把条件变为单独的布尔变量
* 把条件变为单独的方法
* 表驱动

```c
int prePointArray = {1000, 2000, 5000};
int postPointArray = {1000, 2000, 5000};
int levelArray = {1, 2, 3};

for (int i = 0; i <= 2; i++) {
  if ((prePoint < prePointArray[i]) && (postPoint >= postPointArray[i])) {
    triggerGiftEvent(levelArray[i]);
  }
}
```

## 代码可靠性

* 契约式设计：函数在开始前检查参数是否符合前置条件，在结束后检查结果是否符合后置条件
* 防御式编程：对外界环境中所有可能出错的情况进行检查和处理，保护系统稳定运行（多为前置条件，后置条件由调用者检查）
* 实现方式
  * 异常方式：判断条件是否满足，如果不满足则抛出异常
  * 断言方式：在代码中添加断言，检查条件是否满足，如果不满足则抛出异常，`assert Exp1 : Exp2` 若 `Exp1` 为 `false`，则抛出异常，`Exp2` 为异常信息
